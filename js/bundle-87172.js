"use strict";(()=>{var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,s=(s,i,a,n)=>{for(var o,r=n>1?void 0:n?t(i,a):i,l=s.length-1;l>=0;l--)(o=s[l])&&(r=(n?o(i,a,r):o(r))||r);return n&&r&&e(i,a,r),r},i=(e,t,s)=>(((e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)})(e,t,"access private method"),s),a=(e,t,s)=>new Promise(((i,a)=>{var n=e=>{try{r(s.next(e))}catch(e){a(e)}},o=e=>{try{r(s.throw(e))}catch(e){a(e)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,o);r((s=s.apply(e,t)).next())})),n=class{static get root(){return!this._root&&Laya.stage&&(this._root=Laya.stage,this._root.on(Laya.Event.RESIZE,this,this.onResize)),this._root}static get map(){return this._map}static onResize(){const e=Laya.stage.width,t=Laya.stage.height;this.map.forEach((s=>{s.size(e,t)}))}static add(e,t,s){if(!e||!t||t.destroyed)return;if(this._map.has(e))return;t.name=e;let i=this.root;t.zOrder=s;const a=Laya.stage.width,n=Laya.stage.height;t.size(a,n),t.mouseEnabled=!0,t.mouseThrough=!0,i.addChild(t),this._map.set(e,t)}static tryAddChild(e,t){let s=this.map;if(s.has(e)){return s.get(e).addChild(t),!0}return!1}};n._map=new Map;var{regClass:o,property:r}=Laya,l=class extends Laya.Script{constructor(){super(...arguments),this.moveScale=1,this.textureWidth=720,this.repeatX=3,this._startPosX=0}get distance(){return Math.abs(this.owner.x-this._startPosX)}resetPos(){let e=this.owner.x-this._startPosX;this.owner.x=this._startPosX+e%this.textureWidth}isOutOfBounds(){return this.distance*this.repeatX>this.textureWidth}onStart(){const e=this.textureWidth*this.repeatX;this.owner.x=-e,this.owner.width=e*this.repeatX,this._startPosX=this.owner.x}move(e){this.owner.x+=e*this.moveScale,this.isOutOfBounds()&&this.resetPos()}};s([r({type:Number,tips:"移动视差比例"})],l.prototype,"moveScale",2),s([r({type:Number,tips:"纹理默认宽度"})],l.prototype,"textureWidth",2),s([r({type:Number,tips:"初始宽度为原始宽度的倍数"})],l.prototype,"repeatX",2),l=s([o("RPJn7nklQSmMM6nykg0gjQ")],l);var{regClass:h,property:c}=Laya,u=class extends Laya.Script{move(e){this.owner.x+=e}};u=s([h("Z4iI4mU4TKex2UEhifGhvg")],u);var{regClass:d,property:p}=Laya,y=class extends u{constructor(){super(...arguments),this.backgrounds=[],this.autoMove=!1,this.autoMoveSpeed=0}move(e){0!=e&&this.backgrounds.forEach((t=>t.move(e)))}onUpdate(){this.autoMove&&this.move(this.autoMoveSpeed)}randomSkin(){this.setSkin(Math.floor(3*Math.random()))}setSkin(e){this.backgrounds.forEach(((t,s)=>{t.owner.skin=`resources/scene/bg${e}/Layer_${s}.png`}))}enterAnim(){Laya.Tween.from(this.owner,{alpha:0},1e3)}exitAnim(){Laya.Tween.from(this.owner,{alpha:0},1e3)}};s([p({type:[l],tips:"视差背景图层集合"})],y.prototype,"backgrounds",2),s([p({type:Boolean,tips:"是否自动移动"})],y.prototype,"autoMove",2),s([p({type:Number,tips:"自动移动的速度"})],y.prototype,"autoMoveSpeed",2),y=s([d("1bvqChaWTcKNVUxxIpR7YQ")],y);var m=class{};m.JSON_Lang="resources/config/lang/cn.json",m.JSON_Skin="resources/config/skin/skin.json",m.JSON_Dialog="resources/config/dialog.json",m.M_Foot="resources/sound/Foot.mp3",m.M_Main="resources/sound/m_main.mp3",m.M_CatHurt="resources/sound/CatHurt.mp3",m.M_CatJump="resources/sound/CatJump.mp3",m.M_UI_Click="resources/sound/UI_Click.mp3",m.M_UI_Back="resources/sound/UI_Back.mp3",m.M_UI_Forward="resources/sound/UI_Forward.mp3",m.M_UI_Success="resources/sound/UI_Success.mp3",m.LH_Hud="resources/prefabs/views/HUD.lh",m.LH_Help="resources/prefabs/views/Help.lh",m.LH_MainView="resources/prefabs/views/MainView.lh",m.LH_SkinView="resources/prefabs/views/SkinView.lh",m.LH_PauseView="resources/prefabs/views/PauseView.lh",m.LH_WinView="resources/prefabs/views/WinView.lh",m.LH_WinGoldView="resources/prefabs/views/WinGoldView.lh",m.LH_Level_10000="resources/prefabs/level/chapter/Level_10000.lh",m.LH_Level_10001="resources/prefabs/level/chapter/Level_10001.lh",m.LH_Level_10002="resources/prefabs/level/chapter/Level_10002.lh",m.EnterLoadList=[{url:m.JSON_Skin,type:Laya.Loader.JSON},{url:m.JSON_Dialog,type:Laya.Loader.JSON},{url:m.LH_Hud,type:Laya.Loader.HIERARCHY},{url:m.LH_Help,type:Laya.Loader.HIERARCHY},{url:m.LH_MainView,type:Laya.Loader.HIERARCHY},{url:m.LH_SkinView,type:Laya.Loader.HIERARCHY},{url:m.LH_PauseView,type:Laya.Loader.HIERARCHY},{url:m.LH_WinView,type:Laya.Loader.HIERARCHY},{url:m.LH_WinGoldView,type:Laya.Loader.HIERARCHY},{url:m.LH_Level_10000,type:Laya.Loader.HIERARCHY},{url:m.LH_Level_10001,type:Laya.Loader.HIERARCHY},{url:m.LH_Level_10002,type:Laya.Loader.HIERARCHY},{url:m.M_Foot,type:Laya.Loader.SOUND},{url:m.M_Main,type:Laya.Loader.SOUND},{url:m.M_CatHurt,type:Laya.Loader.SOUND},{url:m.M_CatJump,type:Laya.Loader.SOUND},{url:m.M_UI_Click,type:Laya.Loader.SOUND},{url:m.M_UI_Back,type:Laya.Loader.SOUND},{url:m.M_UI_Forward,type:Laya.Loader.SOUND}];var g=m;function _(){return class e{static get ins(){return e._ins||(e._ins=new this),e._ins}}}var{regClass:L,property:v}=Laya,w=class extends Laya.Script{constructor(){super(...arguments),this.fadeTime=100,this.soundEnabled=!0,this.enterSound=g.M_UI_Forward,this.exitSound=g.M_UI_Back,this._viewAni=new Laya.Tween,this._viewAniHandler=new Laya.Handler}set enabledTouch(e){this.owner.mouseEnabled=e}get enabledTouch(){return this.owner.mouseEnabled}enterAnim(){this.enabledTouch=!1,this._viewAniHandler.setTo(this,this.onEnterAniCompleted,null,!1),this._viewAni.from(this.owner,{alpha:0},this.fadeTime,null,this._viewAniHandler)}exitAnim(){this._viewAni.clear(),this.enabledTouch=!1,this._viewAniHandler.setTo(this,this.onExitAniCompleted,null,!1),this._viewAni.to(this.owner,{alpha:0},this.fadeTime,null,this._viewAniHandler)}onEnterAniCompleted(){this.enabledTouch=!0,this._viewAni.clear()}onExitAniCompleted(){this.enabledTouch=!0,this.owner.alpha=1,this._viewAni.clear(),this.exitAniHandler&&this.exitAniHandler.run()}onDestroy(){this._viewAni.clear(),this._viewAniHandler.clear(),this._viewAni=this._viewAniHandler=null}initParams(e){this.param=e}getParams(){return this.param}onEnable(){this.soundEnabled&&Laya.SoundManager.playSound(this.enterSound)}onDisable(){this.soundEnabled&&Laya.SoundManager.playSound(this.exitSound)}closeSelf(){b.ins.close(this.key)}onClickExtra(){this.enabledTouch&&this.closeSelf()}};s([v({type:Number,tips:"渐入渐出动画效果时间"})],w.prototype,"fadeTime",2),s([v({type:Boolean,tips:"是否开启入场音效"})],w.prototype,"soundEnabled",2),s([v({type:String,isAsset:!0,assetTypeFilter:"Audio"})],w.prototype,"enterSound",2),s([v({type:String,isAsset:!0,assetTypeFilter:"Audio"})],w.prototype,"exitSound",2),w=s([L("48p8nPYGQ8qyfc7078Mh9w")],w);var f=class{onResize(){const e=Laya.stage.width|0,t=Laya.stage.height|0;this._mask.size(e,t),this._mask.graphics.clear(),this._mask.graphics.drawRect(0,0,e,t,"#000000")}onClick(){this._view.onClickExtra(),console.log("viewmask======= onclick")}initArea(){this._hitArea=new Laya.Sprite;let e=new Laya.HitArea;e.hit.drawRect(-5e3,-5e3,1e4,1e4,"#ffffff"),this._hitArea.hitArea=e,this._hitArea.mouseEnabled=!0,this._hitArea.mouseThrough=!1,this._hitArea.on(Laya.Event.CLICK,this,this.onClick)}show(e,t=.8){this._view=e;let s=e.owner.parent,i=s.getChildIndex(e.owner);this._mask||(this._mask=new Laya.Sprite),s.addChildAt(this._mask,i),this.onResize(),this._mask.alpha=t,Laya.stage.off(Laya.Event.RESIZE,this,this.onResize),Laya.stage.on(Laya.Event.RESIZE,this,this.onResize)}hide(){this._view=null,this._mask.removeSelf(),Laya.stage.off(Laya.Event.RESIZE,this,this.onResize)}openExtraClick(e){this._view=e,this._hitArea||this.initArea();let t=e.owner.parent,s=t.getChildIndex(e.owner);t.addChildAt(this._hitArea,s)}closeExtraClick(){this._view=null,this._hitArea.removeSelf()}},k=class{static register(e,t,s={},i=null){t?this._map.has(e)?console.warn("warning!!! repeat register id:",e):this._map.set(e,{key:e,parent:t,options:s,prefab:i}):console.warn("warning!!! register parent is null",e,t)}static get(e){return this._map.get(e)}static has(e){return this._map.has(e)}};k._map=new Map;var S,C,b=class extends(_()){constructor(){super(...arguments),this._mask=new f,this._showMap=new Map,this._hideMap=new Map}deleteShowView(e){return this._showMap.delete(e)}getShowView(e){return this._showMap.get(e)}createFromHideMap(e){let t=this._hideMap;if(!t.has(e))return null;let s=t.get(e);return t.delete(e),s.view}open(e,t){let s=this.getShowView(e);if(s)return void console.warn(`warning!!!, 尝试打开一个正在开启中的界面。key: ${e}`);const i=k.get(e);if(!i)return void console.error("该窗口没有注册哦："+e);let a=i.options;if(t=Object.assign({},a,t),s=this.createFromHideMap(e),!s){let t=Laya.loader.getRes(i.prefab);if(s=Laya.Pool.getItemByCreateFun("TP",t.create,t).getComponent(w),s.key=i.key,!s)return void console.error("该窗口没有View脚本组件"+e)}s.initParams(t),n.tryAddChild(i.parent,s.owner)?(a.showMask&&this._mask.show(s),a.extraClick&&this._mask.openExtraClick(s),this._showMap.set(e,s)):console.error("没有对应的父层级",e,i.parent)}_close(e,t=1){let s=this.getShowView(e);if(s){this.deleteShowView(e);let i=s.owner,a=s.getParams();switch(a.showMask&&this._mask.hide(),a.extraClick&&this._mask.closeExtraClick(),t){case 1:i.removeSelf(),this._hideMap.set(e,{view:s,time:-1});break;case 2:i.removeSelf();let t=Date.now()+3e4;this._hideMap.set(e,{view:s,time:t});break;case 3:i.removeSelf(),i.destroy()}}else console.warn("warning!!!, viewMgr try to close invalid view ",e,t)}close(e,t=1){let s=this.getShowView(e);if(s){let i=s.getParams();i&&i.enterAnim?(s.exitAniHandler=new Laya.Handler(this,this._close,[e,t]),s.exitAnim()):this._close(e,t)}else console.warn("warning!!!, viewMgr try to close invalid view ",e,t)}};function H(e,t,s,i){return{fromState:e,event:t,toState:s,cb:i}}var x=class{constructor(e,t=[],s=console){this.transitions=t,this.logger=s,((e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)})(this,S),this._current=e}addTransitions(e){e.forEach((e=>{var t;const s=Object.create(e);s.cb&&!(null==(t=s.cb.name)?void 0:t.startsWith("bound "))&&(s.cb=s.cb.bind(this)),this.transitions.push(s)}))}getState(){return this._current}can(e){return this.transitions.some((t=>t.fromState===this._current&&t.event===e))}getNextState(e){const t=this.transitions.find((t=>t.fromState===this._current&&t.event===e));return null==t?void 0:t.toState}isFinal(){return this.transitions.every((e=>e.fromState!==this._current))}dispatch(e,...t){return a(this,null,(function*(){return new Promise(((s,a)=>{setTimeout((n=>{if(!this.transitions.some((i=>{if(i.fromState===n._current&&i.event===e){if(n._current=i.toState,i.cb)try{const e=i.cb(...t);e instanceof Promise?e.then(s).catch((e=>a(e))):s()}catch(e){this.logger.error("Exception caught in callback",e),a(e)}else s();return!0}return!1}))){const t=i(this,S,C).call(this,n._current,e);this.logger.error(t),a(new Error(t))}}),0,this)}))}))}};S=new WeakSet,C=function(e,t){return`No transition: from ${String(e)} event ${String(t)}`};var M=(e=>(e.init="init",e.loading="loading",e.loaded="loaded",e.home="home",e.level="level",e.pause="pause",e.win="win",e))(M||{}),I=(e=>(e[e.load=100]="load",e[e.loadComplete=101]="loadComplete",e[e.enterHome=102]="enterHome",e[e.enterLevel=103]="enterLevel",e[e.win=104]="win",e[e.nextLevel=105]="nextLevel",e[e.pause=106]="pause",e[e.resume=107]="resume",e[e.restartLevel=108]="restartLevel",e[e.backHome=109]="backHome",e))(I||{}),T=class extends x{constructor(e="init"){super(e),this._id=`GameFSM_${Math.floor(1e4*Math.random())}`;const t=M,s=I;this.addTransitions([H(t.init,s.load,t.loading,this.onLoad),H(t.loading,s.loadComplete,t.loaded,this.onLoadComplete),H(t.loaded,s.enterHome,t.home,this.onEnterHome),H(t.home,s.enterLevel,t.level,this.onEnterLevel),H(t.level,s.win,t.win,this.onWin),H(t.level,s.pause,t.pause,this.onPause),H(t.win,s.nextLevel,t.level,this.onNextLevel),H(t.win,s.restartLevel,t.level,this.onRestartLevel),H(t.win,s.backHome,t.home,this.onBackHome),H(t.pause,s.resume,t.level,this.onResume),H(t.pause,s.restartLevel,t.level,this.onRestartLevel),H(t.pause,s.backHome,t.home,this.onBackHome)])}logState(){this.logger.log(`${this._id} ${[M[this.getState()]]}`)}onLoad(){return a(this,null,(function*(){this.onLoadHandler&&this.onLoadHandler.run()}))}onEnterHome(){return a(this,null,(function*(){this.onEnterHomeHandler&&this.onEnterHomeHandler.run()}))}onLoadComplete(){return a(this,null,(function*(){this.onLoadCompleteHandler&&this.onLoadCompleteHandler.run()}))}onEnterLevel(e){return a(this,null,(function*(){this.onEnterLevelHandler&&this.onEnterLevelHandler.runWith(e)}))}onWin(){return a(this,null,(function*(){this.onWinHandler&&this.onWinHandler.run()}))}onPause(){return a(this,null,(function*(){this.onPauseHandler&&this.onPauseHandler.run()}))}onNextLevel(e){return a(this,null,(function*(){this.onNextLevelHandler&&this.onNextLevelHandler.runWith(e)}))}onResume(){return a(this,null,(function*(){this.onResumeHandler&&this.onResumeHandler.run()}))}onRestartLevel(){return a(this,null,(function*(){this.onRestartLevelHandler&&this.onRestartLevelHandler.run()}))}onBackHome(){return a(this,null,(function*(){this.onBackHomeHandler&&this.onBackHomeHandler.run()}))}},E=class{static delay(e){return new Promise((t=>setTimeout(t,e)))}},D=(e=>(e.HudView="HudView",e.PauseView="PauseView",e.HelpView="HelpView",e.MainView="MainView",e.SkinView="SkinView",e.WinView="WinView",e.WinGoldView="WinGoldView",e))(D||{}),R=(e=>(e.Bg="bg",e.Battle="battle",e.UI="ui_full",e.UISystem="ui_main",e.UIPopup="ui_popup",e.UIMsg="ui_msg",e.UIGuide="ui_guide",e.UILoading="ui_loading",e.UIAlert="ui_alert",e))(R||{}),A=[["bg",10],["battle",20],["ui_full",100],["ui_main",200],["ui_popup",300],["ui_msg",400],["ui_guide",500],["ui_loading",600],["ui_alert",700]],P=class{};P.DistanceChanged="DistanceChanged",P.TopDistanceChanged="TopDistanceChanged";var B={1e4:{path:g.LH_Level_10000},10001:{path:g.LH_Level_10001},10002:{path:g.LH_Level_10002}},V=class{constructor(){this.dict={}}hasListener(e){return!!this.dict[e]}event(e,t){let s=this.dict[e];if(s){for(let e=s.length-1;e>-1;e--){let i=s[e][0];i.runWith(t),i.once&&s.splice(e,1)}return!0}return!1}on(e,t,s,i,a=!1,n=0,o=!0){o&&this.off(e,t,s);let r=this.dict;r[e]=r[e]||[];let l=Laya.Handler.create(t,s,i,a);return r[e].unshift([l,n]),r[e].sort(((e,t)=>e[1]-t[1])),this}once(e,t,s,i,a=0){return this.on(e,t,s,i,!0,a)}off(e,t,s,i=!1){let a=this.dict[e]||[];for(let e=a.length-1;e>-1;e--){let n=a[e][0];n.caller===t&&n.method===s&&n.once===i&&a.splice(e,1)}return this}offAll(e){if(null==e){for(let e in this.dict){this.dict[e].forEach((e=>{e[0].recover(),e[0]=null}))}this.dict={}}else{let t=this.dict[e];t&&t.length>0&&(t.forEach((e=>{e[0].recover(),e[0]=null})),delete this.dict[e])}return this}offAllCaller(e){for(let t in this.dict){let s=this.dict[t];for(let t=s.length-1;t>-1;t--){s[t][0].caller===e&&s.splice(t,1)}}return this}},N=class extends V{},U={skin:{path:g.JSON_Skin,cls:class{constructor(e){this.id=e.id,this.name=e.name,this.icon=e.icon}}},dialog:{path:g.JSON_Dialog,cls:class{constructor(e){this.id=e.id,this.dialogs=e.dialogs}}}},O=class{static get(e){if(null==this.jsonMap[e]){const{cls:t,path:s}=U[e];let i=Laya.loader.getRes(s);if(i){let s=[];for(let e in i.data){let a=new t(i.data[e]);s.push(a)}this.jsonMap[e]=s}}return this.jsonMap[e]}};O.jsonMap={};var F=class e{static get game(){return null==this._game&&(this._game=Laya.LocalStorage.getJSON(e.GAME_KEY)||{}),this._game}static saveGame(){console.log("saveGame=========",this.game),Laya.LocalStorage.setJSON(e.GAME_KEY,this.game)}static save(e,t){this.game[e]=t,Laya.CallLater.I.callLater(this,this.saveGame)}static saveNow(e,t){this.game[e]=t,Laya.CallLater.I.runCallLater(this,this.saveGame)}static load(e){return this.game[e]}};F.GAME_KEY="_game_";var G=F,Y=class{constructor(e,t){this._key=e,this._defaultData=t}get data(){return null==this._data&&(this._data=G.load(this._key),null==this._data&&(this._data=this._defaultData)),this._data}save(){G.save(this._key,this.data)}},W=class e extends Y{constructor(){super(e.Key,e.Default)}newHistoryRecord(e,t){this.data[e]?this.data[e].topScore=t:this.data[e]={topScore:t},this.save()}getHistoryRecord(e){return this.data[e]?this.data[e].topScore:0}};W.Key="LevelLocalData",W.Default={};var X=W,K=class e extends N{constructor(){super(),this._distanceRatio=.00625,this._startSpace=0,this._currDistance=0,this._currTopDistance=0,this._dialogIndex=0,this._enterLevelCount=0,this._localData=new X}static get ins(){return this._ins||(this._ins=new e),this._ins}get currId(){return this._currId}set currId(e){this._currId=e,this._dialogIndex=0,this._freeJumpTimes=1,this._enterLevelCount++}get skin(){return this._enterLevelCount<=1?0:Math.floor(3*Math.random())}get isScrollClose(){return this._isScrollClose}set isScrollClose(e){this._isScrollClose=e}set currDistance(e){this._currDistance=e,this.event(P.DistanceChanged,e),this._currDistance>this.currTopDistance&&(this.currTopDistance=e,this.event(P.TopDistanceChanged,e))}get currDistance(){return this._currDistance}set currTopDistance(e){this._currTopDistance=e}get currTopDistance(){return this._currTopDistance}get currHistoryTopDistance(){return this._localData.getHistoryRecord(this._currId)}get currDistanceFormat(){return this.formatDistance(this.currDistance)}get currTopDistanceFormat(){return this.formatDistance(this.currTopDistance)}get currHistoryTopDistanceFormat(){return this.formatDistance(this.currHistoryTopDistance)}formatDistance(e){const t=Math.floor(e*this._distanceRatio);return Math.max(t,0)}setStartSpace(e){this._startSpace=e}isPracticeMode(){return 1e4==this.currId}isSecondLevel(){return 10002==this.currId}isShowProgress(){return this.isSecondLevel()&&this.currDistance>this._startSpace}isExistTop(){return this.isSecondLevel()&&this.currTopDistance>this.currDistance}isExistScrollButton(){return this.isExistFree()&&(this.isPracticeMode()||this.isSecondLevel())&&this.currTopDistance>this.currDistance}isExistFree(){return this._freeJumpTimes>0}scrollEnd(){this._freeJumpTimes--,this.recordPlayerPos(this.currTopDistance)}recordPlayerPos(e){this.currDistance=e}resetDistance(){this.currDistance=this.currTopDistance=0}checkExistNewRecord(){return this.currTopDistanceFormat>this.currHistoryTopDistanceFormat}saveNewRecord(){this._localData.newHistoryRecord(this._currId,this.currTopDistance)}setLableDialog(e){const t=O.get("dialog").find((e=>e.id==this._currId));if(!t)return;let s=t.dialogs[this._dialogIndex];switch(this._dialogIndex=(this._dialogIndex+1)%t.dialogs.length,e.text=s.desc,s.type){case 1:e.setVar("n",this.currHistoryTopDistanceFormat);break;case 2:e.setVar("n",this.currHistoryTopDistanceFormat-this.currDistanceFormat)}}},J=class extends(_()){init(e){this._boot=e,this._fsm=new T,this._fsm.onLoadHandler=new Laya.Handler(this,this.onLoadHandler,null,!1),this._fsm.onLoadCompleteHandler=new Laya.Handler(this,this.onLoadCompleteHandler,null,!1),this._fsm.onEnterHomeHandler=new Laya.Handler(this,this.onEnterHomeHandler,null,!1),this._fsm.onEnterLevelHandler=new Laya.Handler(this,this.onEnterLevelHandler,null,!1),this._fsm.onWinHandler=new Laya.Handler(this,this.onWinHandler,null,!1),this._fsm.onPauseHandler=new Laya.Handler(this,this.onPauseHandler,null,!1),this._fsm.onNextLevelHandler=new Laya.Handler(this,this.onNextLevelHandler,null,!1),this._fsm.onResumeHandler=new Laya.Handler(this,this.onResumeHandler,null,!1),this._fsm.onRestartLevelHandler=new Laya.Handler(this,this.onRestartLevelHandler,null,!1),this._fsm.onBackHomeHandler=new Laya.Handler(this,this.onBackHomeHandler,null,!1),this._fsm.dispatch(100)}sequeueInit(){return a(this,null,(function*(){yield this.initLangPacks(),this._boot.setLoading({desc:"100003",value:.05}),yield E.delay(20),this.buildScene(),this._boot.setLoading({desc:"100001",value:.1}),yield E.delay(20),this.registerAllView(),this._boot.setLoading({desc:"100002",value:.15}),yield E.delay(20),this._boot.setLoading({desc:"100004"}),this.loadRes(),Laya.SoundManager.setMusicVolume(.5)}))}initLangPacks(){return a(this,null,(function*(){return Laya.loader.load(g.JSON_Lang).then((e=>{Laya.Text.langPacks=e.data}))}))}buildScene(){A.forEach((e=>{const[t,s]=e;n.add(t,new Laya.Sprite,s)}))}registerAllView(){const e=D,t=R;k.register(e.MainView,t.UI,{showMask:!1,extraClick:!1,enterAnim:!1},g.LH_MainView),k.register(e.SkinView,t.UI,{showMask:!0,extraClick:!1,enterAnim:!1},g.LH_SkinView),k.register(e.HelpView,t.UI,{showMask:!0,extraClick:!1,enterAnim:!1},g.LH_Help),k.register(e.HudView,t.UI,{showMask:!1,extraClick:!1,enterAnim:!1},g.LH_Hud),k.register(e.PauseView,t.UI,{showMask:!0,extraClick:!1,enterAnim:!1},g.LH_PauseView),k.register(e.WinView,t.UI,{showMask:!0,extraClick:!1,enterAnim:!1},g.LH_WinView),k.register(e.WinGoldView,t.UI,{showMask:!0,extraClick:!1,enterAnim:!1},g.LH_WinGoldView)}loadRes(){Laya.loader.on(Laya.Event.ERROR,this,this.onLoadError),Laya.loader.load(g.EnterLoadList,null,Laya.Handler.create(this,this.onLoadProgress)).then((()=>{this.onLoadCompleted()}))}openMainView(){this._backgroundRoot.setSkin(0),this._levelLoadMask.ungroup(Laya.Handler.create(this,(()=>{b.ins.open("MainView"),Laya.SoundManager.playMusic(g.M_Main)})))}onLoadCompleted(){this._boot.setLoading({value:.95}),E.delay(20).then((()=>{this._boot.setLoading({desc:"100005",value:1}),Laya.Scene.hideLoadingPage(0),this._levelLoadMask=this._boot.levelLoader.createLoadMask(),this._backgroundRoot=this._boot.levelLoader.createBackgroundRoot(),this._backgroundRoot.enterAnim(),Laya.timer.once(200,this,(()=>{this._fsm.dispatch(101)}))}))}onLoadProgress(e){console.log("progress=====",e)}onLoadError(e){console.log("error=====",e)}onLoadHandler(){this.sequeueInit()}onLoadCompleteHandler(){this._fsm.dispatch(102)}onEnterHomeHandler(){this.openMainView()}onEnterLevelHandler(e){this._levelLoadMask.group(Laya.Handler.create(this,this.onEnterLevelGroupHandler,[e]))}onEnterLevelGroupHandler(e){b.ins.close("MainView"),this._backgroundRoot.autoMove=!1,this._backgroundRoot.setSkin(K.ins.skin),this._level=this._boot.levelLoader.loadLevel(e,this._backgroundRoot),b.ins.open("HudView"),this._levelLoadMask.ungroup()}onWinHandler(){b.ins.close("HudView"),K.ins.isSecondLevel()?b.ins.open("WinGoldView"):b.ins.open("WinView")}onPauseHandler(){b.ins.close("HudView"),b.ins.open("PauseView")}onNextLevelHandler(){this._levelLoadMask.group(Laya.Handler.create(this,this.onNextLevelGroupHandler))}onNextLevelGroupHandler(){this._level.reEnterLevel(10002),b.ins.close("WinView"),b.ins.open("HudView"),this._levelLoadMask.ungroup()}onResumeHandler(){b.ins.open("HudView"),b.ins.close("PauseView")}onRestartLevelHandler(){this._levelLoadMask.group(Laya.Handler.create(this,this.onRestartLevelGroupHandler))}onRestartLevelGroupHandler(){this._levelLoadMask.ungroup(),b.ins.close("PauseView"),b.ins.close("WinGoldView"),this._level.restart(),b.ins.open("HudView")}onBackHomeHandler(){this._levelLoadMask.group(Laya.Handler.create(this,this.onBackHomeGroupHandler))}onBackHomeGroupHandler(){this._boot.levelLoader.unloadLevel(this._level),this._level=null,b.ins.close("PauseView"),b.ins.close("WinGoldView"),this.openMainView()}enterLevel(e){this._fsm.dispatch(103,e)}pause(){this._fsm.dispatch(106,"param")}resume(){this._fsm.dispatch(107)}restartLevel(){this._fsm.dispatch(108)}backHome(){this._fsm.dispatch(109)}nextLevel(){this._fsm.dispatch(105)}win(){this._fsm.dispatch(104)}isWin(){return"win"===this._fsm.getState()}scrollTo(e){this._level.scrollTo(e)}},{regClass:j}=Laya,q=class extends Laya.Script{constructor(){super(...arguments),this._isPressing=!1}init(e){this._target=e}cancel(){this.onMouseOut()}onMouseDown(){this.enabled&&this._target.enabledInput&&!this._isPressing&&(this._isPressing=!0,this._target.onPressed())}onMouseUp(){this.enabled&&this._target.enabledInput&&this._isPressing&&(this._isPressing=!1,this._target.onRelease())}onMouseOut(){this.enabled&&this._target.enabledInput&&this._isPressing&&(this._isPressing=!1,this._target.onPressedCancel())}onDestroy(){this._target=null,this._isPressing=!1}};q=s([j("531VP7jvSxqg_gYKl_Hctg")],q);var z=(e=>(e.Item="Item",e.FoCat="FoCat",e.Ground="Ground",e.Obstacle="Obstacle",e.FinalAward="FinalAward",e))(z||{}),{regClass:Q,property:$}=Laya,Z=class extends Laya.Script{constructor(){super(...arguments),this.followers=[],this.distance=0}get moveToValue(){return this.distance}set moveToValue(e){this.moveTo(e)}isInit(){return null!=this._focusTarget}moveTo(e){this.moveBy(e-this.distance)}moveBy(e){this.distance+=e,this.followers.forEach((t=>t.move(-e)))}onScrollCompleted(e){e&&e.run()}init(e){this._focusTarget=e}backToStart(){this.moveBy(-this.distance)}scrollTo(e,t){Laya.Tween.to(this,{moveToValue:e},800,Laya.Ease.expoIn,Laya.Handler.create(this,this.onScrollCompleted,[t]))}addFollower(e){this.followers.push(e)}onUpdate(){if(!this.isInit())return;const e=.001*Laya.timer.delta;let t=this._focusTarget.velocityX*e;0!=t&&this.moveBy(t)}onDestroy(){this.followers=this._focusTarget=null}};s([$({type:[u]})],Z.prototype,"followers",2),Z=s([Q("26rnaqdcQ4KkKyzSTehrAQ")],Z);var ee=class{static radiansToDegrees(e){return e*this.ONE_RADIANS}static degreesToRadians(e){return e*Math.PI/180}static randomF(e,t){return e+Math.random()*(t-e)}static randomI(e,t){return this.randomF(e,t+.99999)|0}static coinFlip(){return this.randomF(0,1)>.5}static randElement(e){return null==e||0==e.length?null:e[this.randomI(0,e.length-1)]}static chance(e){return Math.random()<e}static isPartiallyOverlap(e,t,s,i){return e<=i&&t>=s}static isIntervalIncluding(e,t,s,i){return e<=s&&t>=i}static isIntervalsDisjoint(e,t,s,i){return t<s||e>i}};ee.INT_MAX_VALUE=2147483647,ee.ONE_RADIANS=180/Math.PI;var te=class{static getAvatar(e){return`resources/icon/avatar/${e}.png`}static getHead(e){return`resources/icon/avatar/${e}_head.png`}static getUiImage(e){return`atlas/ui/${e}.png`}},se=class{};se.Unlcok="Unlcok",se.Adventure="Adventure";var ie=class e extends Y{constructor(){super(e.Key,e.Default)}unlock(e){this.data.idleSkinIds.push(e),this.save()}adventure(e){this.data.skinId=e,this.save()}};ie.Key="SkinLocalData",ie.Default={skinId:"100001",idleSkinIds:["100001"]};var ae=ie,ne=class e extends N{constructor(){super(),this._localData=new ae}static get ins(){return this._ins||(this._ins=new e),this._ins}checkStatus(e){let t=this._localData.data;return t.skinId===e?2:t.idleSkinIds.some((t=>t===e))?1:0}getList(){let e=[];const t=O.get("skin");for(let s=0;s<t.length;s++){const i=t[s];e.push({id:i.id,lblName:i.name,status:this.checkStatus(i.id),imgAvatar:te.getAvatar(i.icon)})}return e}unlock(e){O.get("skin").some((t=>t.id===e))?(this._localData.data.idleSkinIds.push(e),this._localData.unlock(e),this.event(se.Unlcok,e)):console.warn("unlock fail!!!, this skin is not exist!",e)}adventure(e){O.get("skin").some((t=>t.id===e))?(this._localData.adventure(e),this.event(se.Adventure,e)):console.warn("unlock fail!!!, this skin is not exist!",e)}getCurrentSkin(){let e=this._localData.data.skinId;let t=O.get("skin").find((t=>t.id===e));return te.getAvatar(t.icon)}getCurrentSkinHead(){let e=this._localData.data.skinId;let t=O.get("skin").find((t=>t.id===e));return te.getHead(t.icon)}},{property:oe,regClass:re}=Laya,le=class extends Laya.Script{constructor(){super(...arguments),this.velocityX=0,this.velocityY=0,this.degrees=35,this.forceVelocity=800,this.maxTime=1800,this.minForce=250,this.grav=-9.8,this._isGround=!1,this._isPressed=!1,this._pressedTime=0,this._isScrolling=!1,this._isPausing=!1,this._footPoint=Laya.Point.create(),this._collisionBox=Laya.Rectangle.create()}get isGround(){return this._isGround}set isGround(e){this._isGround=e}get enabledInput(){return this.isGround}get zoomVelocity(){return.7/this.maxTime}get collisionBox(){let e=Laya.Point.create();return this.collisionBoxNode.localToGlobal(e),this._collisionBox.setTo(e.x,e.y,this.collisionBoxNode.width,this.collisionBoxNode.height),this._collisionBox}onPressed(){this._isPressed=!0,this._pressedTime=0}onPressedCancel(){this._isPressed=!1,this._pressedTime=0,this.imgIcon.scaleY=1}onRelease(){let e=this._pressedTime*this.forceVelocity*.001;e=Math.max(e,this.minForce),this.addForce(e,this.degrees),Laya.SoundManager.playSound(g.M_CatJump),this._isPressed=!1,this._pressedTime=0,this.imgIcon.scaleY=1}onStart(){this.imgIcon.skin=ne.ins.getCurrentSkin()}onUpdate(){this._isPausing||this._isScrolling||(this.move(),this.press())}onDestroy(){this._collisionBox.recover(),this._collisionBox=null}isBelowHeight(e){return this.owner.y>=e}getFootPoint(e){const{x:t,y:s}=this.spFoot;return this._footPoint.setTo(t,s),e.globalToLocal(this.owner.localToGlobal(this._footPoint))}spawn(e,t){this.owner.visible=!0,this.owner.pos(e,null==t?this.owner.y:t)}pause(){this._isPausing=!0}resume(){this._isPausing=!1}hide(){this._isScrolling=!0,this.stop(),Laya.Tween.to(this.owner,{alpha:0},400,null,Laya.Handler.create(this,(()=>{this.owner.visible=!1})),0,!0,!0)}show(){this.owner.alpha=1,this.owner.visible=!0,this._isScrolling=!1,Laya.Tween.from(this.owner,{alpha:0},400,null,null,0,!0,!0)}stop(){this.velocityX=this.velocityY=0}move(){const e=.001*Laya.timer.delta;this.owner.y-=this.velocityY*e,this.isGround||(this.velocityY+=this.grav*e)}addForce(e,t){const s=ee.degreesToRadians(t),i=e*Math.cos(s),a=e*Math.sin(s);this.velocityX=i,this.velocityY=a}press(){this._isPressed&&(this._pressedTime+=Laya.timer.delta,this._pressedTime=Math.min(this._pressedTime,this.maxTime),this.imgIcon.scaleY=1-this._pressedTime*this.zoomVelocity)}};s([oe({type:Number,tips:"默认的弹跳角度"})],le.prototype,"degrees",2),s([oe({type:Number,tips:"跳跃力度增长系数"})],le.prototype,"forceVelocity",2),s([oe({type:Number,tips:"点击有效时间"})],le.prototype,"maxTime",2),s([oe({type:Number,tips:"最小促发力度"})],le.prototype,"minForce",2),s([oe({type:Number,tips:"重力加速度"})],le.prototype,"grav",2),s([oe({type:Laya.Image,tips:"icon"})],le.prototype,"imgIcon",2),s([oe({type:Laya.Box,tips:"碰撞检测范围"})],le.prototype,"collisionBoxNode",2),s([oe({type:Laya.Sprite,tips:"脚部中心点"})],le.prototype,"spFoot",2),le=s([re("zd0DmzjxScCZRghCm3Fuvw")],le);var he=class{static intersection(e,t){return e.filter((e=>-1!==t.indexOf(e)))}static difference(e,t){return e.filter((e=>-1===t.indexOf(e)))}static union(e,t){return[...new Set([...e,...t])]}static clear(e){e.length=0}},ce=class{constructor(e,t){this.min=e,this.max=t,this.left=null,this.right=null,this.intersects=[]}},ue=class{constructor(){this.root=null}buildTree(e){if(0===e.length)return;const t=Math.min(...e.map((e=>e.min))),s=Math.max(...e.map((e=>e.max)));this.root=this._buildTree(e,t,s)}_buildTree(e,t,s){if(t>s)return null;const i=new ce(t,s);if(t<s){const a=Math.floor((t+s)/2);i.left=this._buildTree(e,t,a),i.right=this._buildTree(e,a+1,s)}return i.intersects=e.filter((e=>e.min<=i.max&&e.max>=i.min)),i}query(e,t,s){const i=[];return null===e||t>e.max||s<e.min?i:t<=e.min&&s>=e.max?e.intersects:(i.push(...this.query(e.left,t,s)),i.push(...this.query(e.right,t,s)),[...new Set(i)])}clear(){this.root=null}},{regClass:de,classInfo:pe,property:ye}=Laya,me=class extends Laya.Script{constructor(){super(...arguments),this.type="Item",this._collisionBox=Laya.Rectangle.create()}get collisionBox(){let e=Laya.Point.create();return this.owner.localToGlobal(e),this._collisionBox.setTo(e.x,e.y,this.owner.width,this.owner.height),this._collisionBox}collisionEvent(){}onDestroy(){this._collisionBox.recover(),this._collisionBox=null}};s([ye({type:z})],me.prototype,"type",2),me=s([de("_ZAqw5yNQ12PhlYHes3dTA"),pe({menu:"Level_Item",caption:"Item"})],me);var ge=class e{get min(){return this._min}get max(){return this._max}get data(){return this._data}get sign(){return this._data._$prefab}get rootName(){return this._rootName}constructor(t,s){this._data=t,this._rootName=s;const{x:i,width:a,anchorX:n}=t;[this._min,this._max]=e.translate(i,a,n)}static translate(t,s,i){t=null==t?0:t,s=null==s?0:s,i=null==i?0:i;const a=e.RATIO,n=t-s*i,o=n+s;return[Math.floor(n*a),Math.ceil(o*a)]}};ge.RATIO=.01;var _e=ge,{regClass:Le,property:ve}=Laya,we=class extends Laya.Script{constructor(){super(...arguments),this._prefabMap=new Map,this._screenOffset=0}get items(){let e=this.getItemsByType("Item");return e=e.concat(this.getItemsByType("FoCat")),e=e.concat(this.getItemsByType("FinalAward")),e}get grounds(){return this.getItemsByType("Ground")}get obstacles(){return this.getItemsByType("Obstacle")}getItemsByType(e){let t=[];return this._prefabMap.forEach((s=>{s.type===e&&t.push(s)})),t}createNode(e,t){let s=Laya.Pool.getItem(e);if(!s){s=Laya.loader.getRes(t._$prefab).create()}return s.x=t.x,s.y=t.y,null!=t.width&&(s.width=t.width),null!=t.height&&(s.height=t.height),null!=t.anchorX&&(s.anchorX=t.anchorX),null!=t.anchorY&&(s.anchorY=t.anchorY),s}removeAndRecoverNode(e,t){t.removeSelf(),Laya.Pool.recover(e,t)}parse(e,t){let s=[];const i=B[e];return Laya.loader.getRes(i.path).data._$child.forEach((e=>{if(t.some((t=>t===e.name))&&e._$child&&e._$child.length>0){let t=e._$child.map((t=>new _e(t,e.name)));s=s.concat(t)}})),s}refreshNodes(){let e=this._tree;if(null==e)return;const[t,s]=this.getCameraRange();if(null!=this._screenRange&&this._screenRange[0]==t&&this._screenRange[1]==s)return;this._screenRange=[t,s];const i=e.query(e.root,t,s);let a=Array.from(this._prefabMap.keys());he.difference(a,i).forEach((e=>{let t=this._prefabMap.get(e);t?(this.removeAndRecoverNode(e.sign,t.owner),this._prefabMap.delete(e)):console.log("remove item but item not in map ",e)})),he.difference(i,a).forEach((e=>{let t=this.createNode(e.sign,e.data);this[e.rootName].addChild(t),this._prefabMap.set(e,t.getComponent(me))}))}getCameraRange(){let e=this.cameraDistance,t=this.camera.distance-e-this._screenOffset,s=Laya.stage.width+2*e;return _e.translate(t,s,0)}init(e,t){let s=this.parse(e,["itemRoot","groundRoot","obstacleRoot"]),i=new ue;i.buildTree(s),this._tree=i,this._screenOffset=t,this.refreshNodes()}clear(){this._screenRange=null,this._prefabMap.forEach(((e,t)=>this.removeAndRecoverNode(t.sign,e.owner))),this._prefabMap.clear(),this._tree.clear()}onUpdate(){this.refreshNodes()}};s([ve({type:Laya.Sprite,tips:"地面根节点"})],we.prototype,"groundRoot",2),s([ve({type:Laya.Sprite,tips:"障碍物根节点"})],we.prototype,"obstacleRoot",2),s([ve({type:Laya.Sprite,tips:"物品根节点"})],we.prototype,"itemRoot",2),s([ve({type:Z,tips:"LevelCamera"})],we.prototype,"camera",2),s([ve({type:Number,tips:"extent distance"})],we.prototype,"cameraDistance",2),we=s([Le("U9HwoF4wSgeF-f2oUaWn8w")],we);var{regClass:fe,property:ke}=Laya,Se=class extends Laya.Script{constructor(){super(...arguments),this._isInit=!1,this._enabledCollision=!0}get spawnPoint(){const{x:e,y:t}=this.player.owner;return[e,t]}parsePrefabData(e,t){this.nodeManager.init(e,t)}checkCollision(){const e=this.player.collisionBox;let t=this.nodeManager.items,s=this.tryCheckCollision(e,t);s&&"FinalAward"==s.type&&(J.ins.win(),this._enabledCollision=!1,this.player.stop(),this.player.pause()),s&&"FoCat"==s.type&&s.collisionEvent();let i=this.nodeManager.obstacles,a=this.tryCheckCollision(e,i);if(a)return this.inputManager.cancel(),this.player.addForce(a.force,a.degrees),this.showHurtEffect(),void Laya.SoundManager.playSound(g.M_CatHurt);let n=this.nodeManager.grounds,o=n.filter((e=>e.isScrollBack)),r=n.filter((e=>!e.isScrollBack)),l=this.tryCheckCollision(e,o);l||(l=this.tryCheckCollision(e,r));const h=null!=l;this.player.isGround!=h&&(this.player.isGround=h,h&&(l.isScrollBack?(this.player.velocityY=0,this.player.velocityX=-l.moveSpeed):this.player.stop(),this.recordPlayerPos(),this.showDustEffect(),this.player.owner.y=l.owner.y,Laya.SoundManager.playSound(g.M_Foot)))}tryCheckCollision(e,t){return t.find((t=>t.collisionBox.intersects(e)))}onAnimDustComplete(){this.animDust.visible=!1}onAnimHurtComplete(){this.animHurt.visible=!1}onAwake(){this.animDust.on(Laya.Event.COMPLETE,this,this.onAnimDustComplete),this.animHurt.on(Laya.Event.COMPLETE,this,this.onAnimHurtComplete)}onUpdate(){this._isInit&&this._enabledCollision&&this.checkCollision()}onDestroy(){K.ins.resetDistance()}init(e,t){if(this._isInit)return;this._isInit=!0,K.ins.currId=e;let s=this.config[e];this.moveRoot.x=s,this.uiRoot.x=-s;let i=s-this.spawnPoint[0];K.ins.setStartSpace(i),this.parsePrefabData(e,s),this.player.spawn(...this.spawnPoint),this.inputManager.init(this.player),this.levelCamera.init(this.player),this.levelCamera.addFollower(t),this.backgroundRoot=t}recordPlayerPos(){K.ins.recordPlayerPos(this.levelCamera.distance)}reEnterLevel(e){K.ins.currId=e,this.levelCamera.backToStart(),K.ins.resetDistance();let t=this.config[e];this.moveRoot.x=t,this.uiRoot.x=-t;let s=t-this.spawnPoint[0];K.ins.setStartSpace(s),this.nodeManager.clear(),this.parsePrefabData(e,t),this._enabledCollision=!0,this.player.resume()}restart(){this.reEnterLevel(K.ins.currId)}scrollTo(e){this.player.hide(),this._enabledCollision=!1,this.inputManager.enabled=!1,K.ins.isScrollClose=!0,b.ins.close("HudView"),this.levelCamera.scrollTo(e,Laya.Handler.create(this,(()=>{this.player.show(),this._enabledCollision=!0,this.inputManager.enabled=!0,K.ins.scrollEnd(),b.ins.open("HudView"),K.ins.isScrollClose=!1}),null,!0))}showDustEffect(){this.animDust.visible=!0;let e=this.player.getFootPoint(this.effectRoot);this.animDust.pos(e.x,e.y),this.animDust.play(0,!1)}showHurtEffect(){this.animHurt.visible=!0;let e=this.player.getFootPoint(this.effectRoot);this.animHurt.pos(e.x,e.y),this.animHurt.play(0,!1)}};s([ke({type:Laya.Sprite,tips:"地面根节点"})],Se.prototype,"moveRoot",2),s([ke({type:Laya.Sprite,tips:"地面根节点"})],Se.prototype,"groundRoot",2),s([ke({type:Laya.Sprite,tips:"障碍物根节点"})],Se.prototype,"obstacleRoot",2),s([ke({type:Laya.Sprite,tips:"物品根节点"})],Se.prototype,"itemRoot",2),s([ke({type:Laya.Sprite,tips:"特效根节点"})],Se.prototype,"effectRoot",2),s([ke({type:Laya.Sprite,tips:"ui根节点"})],Se.prototype,"uiRoot",2),s([ke({type:q,tips:"关卡输入控制"})],Se.prototype,"inputManager",2),s([ke({type:we,tips:"关卡节点管理"})],Se.prototype,"nodeManager",2),s([ke({type:le,tips:"角色"})],Se.prototype,"player",2),s([ke({type:Z,tips:"相机控制"})],Se.prototype,"levelCamera",2),s([ke({type:["Record",Number],tips:"配置"})],Se.prototype,"config",2),s([ke({type:Laya.Animation,tips:"受击特效"})],Se.prototype,"animHurt",2),s([ke({type:Laya.Animation,tips:"落地特效"})],Se.prototype,"animDust",2),Se=s([fe("gdNq6cQdR8yxEsxFaMzThA")],Se);var{regClass:Ce,property:be}=Laya,He=class extends Laya.Script{constructor(){super(...arguments),this.fadeTime=200}onStart(){const{width:e,height:t}=Laya.stage,s=e/2;this.owner.x=s,this.leftSp.x=-s,this.rightSp.x=s,this.maskBox.size(e,t),this.maskBox.mouseEnabled=!1}pingpong(){this.group(Laya.Handler.create(this,this.ungroup))}group(e){const t=Laya.stage.width/2,s=this.fadeTime;this._groupHandler=e,this.leftSp.x=-t,this.rightSp.x=t,Laya.Tween.clearAll(this.leftSp),Laya.Tween.clearAll(this.rightSp),this.maskBox.mouseEnabled=!0,Laya.Tween.to(this.leftSp,{x:280},s,Laya.Ease.expoOut,Laya.Handler.create(this,(()=>{this._groupHandler&&this._groupHandler.run(),this.maskBox.mouseEnabled=!1}))),Laya.Tween.to(this.rightSp,{x:-280},s,Laya.Ease.expoOut,Laya.Handler.create(this,(()=>{})))}ungroup(e){const t=Laya.stage.width/2,s=this.fadeTime;this._ungroupHandler=e,this.leftSp.x=280,this.rightSp.x=-280,Laya.Tween.clearAll(this.leftSp),Laya.Tween.clearAll(this.rightSp),this.maskBox.mouseEnabled=!0,Laya.Tween.to(this.leftSp,{x:-t},s,Laya.Ease.linearOut,Laya.Handler.create(this,(()=>{this._ungroupHandler&&this._ungroupHandler.run(),this.maskBox.mouseEnabled=!1})),200),Laya.Tween.to(this.rightSp,{x:t},s,Laya.Ease.linearOut,Laya.Handler.create(this,(()=>{})),200)}onDestroy(){Laya.Tween.clearAll(this.leftSp),Laya.Tween.clearAll(this.rightSp),this._groupHandler=this._ungroupHandler=null}};s([be({type:Laya.Box,tips:"mask Node"})],He.prototype,"maskBox",2),s([be({type:Laya.Sprite,tips:"left Node"})],He.prototype,"leftSp",2),s([be({type:Laya.Sprite,tips:"left Node"})],He.prototype,"rightSp",2),s([be({type:Number,tips:"过度动画时间"})],He.prototype,"fadeTime",2),He=s([Ce("JblJ40T4RQiSffUI3CMHRQ")],He);var{regClass:xe,property:Me}=Laya,Ie=class extends Laya.Script{get root(){return this.owner.parent}createLoadMask(){let e=this.loadMask.create();return n.tryAddChild("ui_loading",e),e.getComponent(He)}createBackgroundRoot(){let e=this.backgroundRootPrefab.create();return this.root.addChild(e),e.getComponent(y)}loadLevel(e,t){let s=this.levelBasePrefab.create();this.root.addChild(s);let i=s.getComponent(Se);return i.init(e,t),i}unloadLevel(e){K.ins.currId=null,e.owner.destroy()}};s([Me({type:Laya.Prefab,tips:"关卡基础控件"})],Ie.prototype,"levelBasePrefab",2),s([Me({type:Laya.Prefab,tips:"视差滚动背景"})],Ie.prototype,"backgroundRootPrefab",2),s([Me({type:Laya.Prefab,tips:"场景过度动画节点"})],Ie.prototype,"loadMask",2),Ie=s([xe("Su0EkWj0SwqpWfz8UgRgXQ")],Ie);var{regClass:Te,property:Ee}=Laya,De=class extends Laya.Script{onAwake(){let e=this.loadingPrefab.create();this._loadingNode=e,e.value=0,Laya.Scene.setLoadingPage(e),Laya.Scene.showLoadingPage(),J.ins.init(this)}setLoading(e){null!=e.desc&&(this._loadingNode.desc=e.desc),null!=e.value&&(this._loadingNode.value=e.value)}};s([Ee({type:Laya.Prefab})],De.prototype,"loadingPrefab",2),s([Ee({type:Ie})],De.prototype,"levelLoader",2),De=s([Te("_5jimj6UQcO08rZS4r0zwg")],De);var{regClass:Re,classInfo:Ae,property:Pe}=Laya,Be=class extends Laya.Script{onMouseDown(e){Laya.SoundManager.playSound(this.sound)}};s([Pe({type:String,isAsset:!0,assetTypeFilter:"Audio"})],Be.prototype,"sound",2),Be=s([Re("UaO-bWBXT3G__1Qq1YV3Vg"),Ae({menu:"UI"})],Be);var{regClass:Ve,classInfo:Ne,property:Ue}=Laya,Oe=class extends Laya.Script{constructor(){super(...arguments),this.duration=100,this.scale=.9,this.isAnchorCenterRequired=!0}onOutOrUp(){this._isZooming&&this._tween.to(this.owner,{scaleX:this._scaleX,scaleY:this._scaleY},this.duration)}get isAnchorCenter(){return.5==this.owner.anchorX&&.5==this.owner.anchorY}onStart(){this._tween=new Laya.Tween,this._scaleX=this.owner.scaleX,this._scaleY=this.owner.scaleY}onDestroy(){this._tween.clear(),this._tween=null}onMouseUp(e){this.onOutOrUp()}onMouseOut(e){this.onOutOrUp()}onMouseDown(e){if(this.isAnchorCenterRequired&&!this.isAnchorCenter)return void console.warn("ClickZoom owner anchor is not center",this.owner.anchorX,this.owner.anchorX);this._isZooming=!0;const t=this.scale,s=this._scaleX*t,i=this._scaleY*t;this._tween.to(this.owner,{scaleX:s,scaleY:i},this.duration)}};s([Ue({type:Number,tips:"缩放动画时间"})],Oe.prototype,"duration",2),s([Ue({type:Number,tips:"相较初始值缩放的比例"})],Oe.prototype,"scale",2),s([Ue({type:Boolean,tips:"要求锚点必须居中，否则不做缩放效果"})],Oe.prototype,"isAnchorCenterRequired",2),Oe=s([Ve("ndymGYpfSqyFWrTZECZtvw"),Ne({menu:"UI"})],Oe);var{regClass:Fe,classInfo:Ge,property:Ye}=Laya,We=class extends me{};We=s([Fe("KIkYD55CRjqq9nX0jWpMhQ"),Ge({menu:"Level_Item",caption:"FinalAward"})],We);var{regClass:Xe,classInfo:Ke,property:Je}=Laya,je=class extends me{constructor(){super(...arguments),this._hideTime=0,this._isShowing=!1}get collisionBox(){let e=Laya.Point.create();return this.collisionBoxNode.localToGlobal(e),this._collisionBox.setTo(e.x,e.y,this.collisionBoxNode.width,this.collisionBoxNode.height),this._collisionBox}showRandomDialog(){this._isShowing=!0,this.imgDialog.alpha=1,this.imgDialog.visible=!0,K.ins.setLableDialog(this.lblDesc),Laya.Tween.from(this.imgDialog,{alpha:0},300)}hideRandomDialog(){Laya.Tween.to(this.imgDialog,{alpha:0},300)}collisionEvent(){this._hideTime=1e3,this._isShowing||this.showRandomDialog()}onUpdate(){this._hideTime>0?this._hideTime-=Laya.timer.delta:this._isShowing&&(this._hideTime=0,this._isShowing=!1,this.hideRandomDialog())}};s([Je({type:Laya.Label})],je.prototype,"lblDesc",2),s([Je({type:Laya.Image})],je.prototype,"imgDialog",2),s([Je({type:Laya.Box,tips:"碰撞检测范围"})],je.prototype,"collisionBoxNode",2),je=s([Xe("9qvDpwgPQ7C7xTf4hjINNw"),Ke({menu:"Level_Item",caption:"FoCat"})],je);var{regClass:qe,classInfo:ze,property:Qe}=Laya,$e=class extends me{constructor(){super(...arguments),this.isScrollBack=!1,this.moveSpeed=100}};s([Qe({type:Boolean,tips:"是否向后移动"})],$e.prototype,"isScrollBack",2),s([Qe({type:Number,tips:"移动速度"})],$e.prototype,"moveSpeed",2),$e=s([qe("5Vyahl1_TI2BV_0Y_iVXRA"),ze({menu:"Level_Item",caption:"Ground"})],$e);var{regClass:Ze,classInfo:et,property:tt}=Laya,st=class extends me{onStart(){}checkCollision(){}onUpdate(){}};s([tt({type:Number,tips:"默认的弹跳角度"})],st.prototype,"degrees",2),s([tt({type:Number,tips:"弹力"})],st.prototype,"force",2),st=s([Ze("jkAgo5LeRDOcX9FNEnGyDw"),et({menu:"Level_Item",caption:"Obstacle"})],st);var{regClass:it,classInfo:at,property:nt}=Laya,ot=class extends st{constructor(){super(...arguments),this.moveHight=100,this.moveDuration=1e3,this.delayDuration=1e3}get collisionBox(){let e=Laya.Point.create();return this.moveImage.localToGlobal(e),this._collisionBox.setTo(e.x,e.y,this.owner.width,this.owner.height),this._collisionBox}onAwake(){this._startY=this.moveImage.y;const{moveHight:e,moveDuration:t,delayDuration:s}=this;let i=this._startY,a=i-e;this._timeLine=new Laya.TimeLine,this._timeLine.to(this.moveImage,{y:a},t),this._timeLine.to(this.moveImage,{y:i},t),this._timeLine.to(this.moveImage,{},s)}onEnable(){this._timeLine.play(0,!0)}onDisable(){this._timeLine.pause(),this.moveImage.y=this._startY}onDestroy(){this._timeLine.destroy(),this._timeLine=null}};s([nt({type:Laya.Image,tips:"移动节点"})],ot.prototype,"moveImage",2),s([nt({type:Number,tips:"移动高度"})],ot.prototype,"moveHight",2),s([nt({type:Number,tips:"移动高度"})],ot.prototype,"moveDuration",2),s([nt({type:Number,tips:"中间停顿的时间"})],ot.prototype,"delayDuration",2),ot=s([it("0M4iAbbLSreUj7BCD0cBZw"),at({menu:"Level_Item",caption:"MoveObstacle"})],ot);var rt=class extends Laya.Box{},{regClass:lt}=Laya,ht=class extends rt{onClickClose(){b.ins.close("HelpView")}onAwake(){this.btnClose.on(Laya.Event.CLICK,this.onClickClose)}};ht=s([lt("724uCNpAQMy7qJJMphuxfQ")],ht);var ct=class extends Laya.Box{},{regClass:ut}=Laya,dt=class extends ct{updateView(){this.updateDistance(),this.updateProgress(),this.updateScrollButton()}updateProgress(){const e=K.ins.isShowProgress();this.progress.visible=e,e&&(this.imgHead.skin=ne.ins.getCurrentSkinHead(),this.progress.value=.01*K.ins.currDistanceFormat,this.imgHead.x=this.progress.width*this.progress.value)}updateDistance(){const e=K.ins.isPracticeMode();if(this.lblDistance.visible=e,e){const e=K.ins.currDistanceFormat;this.lblDistance.text=`当前距离：${e}`}}updateScrollButton(){this.btnScroll.visible=K.ins.isExistScrollButton()}onClickBack(){J.ins.pause()}onClickScroll(){J.ins.scrollTo(K.ins.currTopDistance)}onClickContinue(){this.btnBack.visible=!0,this.boxMask.visible=!1}onAwake(){this.btnBack.on(Laya.Event.CLICK,this,this.onClickBack),this.btnScroll.on(Laya.Event.CLICK,this,this.onClickScroll),this.btnContinue.on(Laya.Event.CLICK,this,this.onClickContinue)}onEnable(){K.ins.isScrollClose&&(this.btnBack.visible=!1,this.boxMask.visible=!0),this.updateView(),K.ins.on(P.DistanceChanged,this,this.updateView)}onDisable(){K.ins.off(P.DistanceChanged,this,this.updateView)}};dt=s([ut("DZz_alBTSaO1F05kyRRVdQ")],dt);var pt=class{static toPercent(e,t=2){return`${(100*e).toFixed(t)}%`}static lang(e){return Laya.Text.langPacks?Laya.Text.langPacks[e]:e}static format(e,...t){return e.replace(/{(\d+)}/g,((e,s)=>{let i=t[Number(s)];return i=this.lang(i),void 0!==i?i:e}))}},yt=class extends Laya.Box{},{regClass:mt}=Laya,gt=class extends yt{constructor(){super(...arguments),this._desc="100000"}get value(){return this._value}set value(e){this._value=e,this.progress.value=e,this.lblProgress.text=`${pt.lang(this.desc)}...${pt.toPercent(e)}`}get desc(){return this._desc}set desc(e){this._desc=e}};gt=s([mt("v9tA_oycTPuSD8EWz2Vrhg")],gt);var _t=class extends Laya.Box{},{regClass:Lt}=Laya,vt=class extends _t{onClickHelp(){b.ins.open("HelpView")}onClickSkin(){b.ins.open("SkinView")}onClickPlay(){J.ins.enterLevel(10001)}onClickPractice(){J.ins.enterLevel(1e4)}onAwake(){this.btnHelp.on(Laya.Event.CLICK,this.onClickHelp),this.btnSkin.on(Laya.Event.CLICK,this.onClickSkin),this.btnPlay.on(Laya.Event.CLICK,this.onClickPlay)}};vt=s([Lt("XIivA9gIT5afkoSujgYOhg")],vt);var wt=class extends Laya.Box{},{regClass:ft}=Laya,kt=class extends wt{updateView(){let e=K.ins.isPracticeMode();if(this.boxNormal.visible=!e,this.boxPractice.visible=e,e){let e=K.ins.checkExistNewRecord();this.imgNewRecord.visible=e,this.lblCurrentScore.text=K.ins.currTopDistanceFormat.toString(),e&&K.ins.saveNewRecord(),this.lblHistoryScore.text=K.ins.currHistoryTopDistanceFormat.toString()}else this.imgIcon.skin=ne.ins.getCurrentSkin()}onClickResume(){J.ins.resume()}onClickRestart(){J.ins.restartLevel()}onClickMainMenu(){J.ins.backHome()}onAwake(){this.btnClose.on(Laya.Event.CLICK,this.onClickResume),this.btnResume.on(Laya.Event.CLICK,this.onClickResume),this.btnRestart.on(Laya.Event.CLICK,this.onClickRestart),this.btnMainMenu.on(Laya.Event.CLICK,this.onClickMainMenu)}onEnable(){this.updateView()}};kt=s([ft("dcYZ3h0vTF2guQREWLyw1A")],kt);var St=class extends Laya.Box{},{regClass:Ct}=Laya,bt=class extends St{get dataSource(){return super.dataSource}set dataSource(e){if(super.dataSource=e,!e)return;let t=e.status;if(null!=t){let e=1==t,s=0==t,i=2==t;this.imgBg.skin=te.getUiImage(s?"com_box_2":"com_box_1"),this.imgAvatarBg.skin=te.getUiImage(s?"img_avatar_bg_2":"img_avatar_bg_1"),this.imgVideo.visible=s,this.imgAdventuring.visible=i,this.btnUnlock.visible=s,this.btnAdventure.visible=e}}};bt=s([Ct("0fuhQCstRXStUASD0xkUfw")],bt);var Ht=class extends V{},xt=class e extends Ht{constructor(){super(),this.model=ne.ins}static get ins(){return null==this._ins&&(this._ins=new e),this._ins}unlcok(e){this.model.unlock(e)}adventure(e){this.model.adventure(e)}},Mt=class extends Laya.Box{},{regClass:It}=Laya,Tt=class extends Mt{onClickClose(){b.ins.close("SkinView")}onItemMouse(e,t){if(e.type==Laya.Event.CLICK){let s=this.list.array[t];"btnAdventure"==e.target.name?xt.ins.adventure(s.id):"btnUnlock"==e.target.name&&xt.ins.unlcok(s.id)}}refreshStatus(e){let t=this.list.array,s=t.findIndex((t=>t.id===e)),i=t[s];i.status=ne.ins.checkStatus(e),this.list.changeItem(s,i)}onSkinAdventure(e){let t=this.list.array.find((e=>2===e.status));this.refreshStatus(t.id),this.refreshStatus(e)}onSkinUnlock(e){this.refreshStatus(e)}onAwake(){this.btnClose.on(Laya.Event.CLICK,this.onClickClose),this.list.mouseHandler=new Laya.Handler(this,this.onItemMouse,null,!1)}onEnable(){ne.ins.on(se.Unlcok,this,this.onSkinUnlock),ne.ins.on(se.Adventure,this,this.onSkinAdventure),this.list.array=ne.ins.getList()}onDisable(){ne.ins.off(se.Unlcok,this,this.onSkinUnlock),ne.ins.off(se.Adventure,this,this.onSkinAdventure)}};Tt=s([It("waOd0QPkRrGqOVRstGR5MA")],Tt);var Et=class extends Laya.Box{},{regClass:Dt}=Laya,Rt=class extends Et{onClickHome(){J.ins.backHome()}onClickAgain(){J.ins.restartLevel()}onAwake(){this._timeLine=new Laya.TimeLine,this._timeLine.from(this.imgGold,{scaleX:0,scaleY:0,alpha:0},600,Laya.Ease.bounceOut),this._timeLine.from(this.imgReceived,{scaleX:5,scaleY:5,alpha:0},600,Laya.Ease.bounceOut),this.btnHome.on(Laya.Event.CLICK,this.onClickHome),this.btnAgain.on(Laya.Event.CLICK,this.onClickAgain)}onEnable(){this._timeLine.play(0,!1)}onDisable(){this._timeLine.pause()}onDestroy(){this._timeLine.destroy(),this._timeLine=null}};Rt=s([Dt("2JeyCivoRbuwPF4U0JmvRg")],Rt);var At=class extends Laya.Box{},{regClass:Pt}=Laya,Bt=class extends At{onClickContinue(){J.ins.nextLevel()}onAwake(){this._timeLine=new Laya.TimeLine,this._timeLine.from(this.imgSilver,{scaleX:0,scaleY:0,alpha:0},600,Laya.Ease.bounceOut),this._timeLine.from(this.imgReceived,{scaleX:5,scaleY:5,alpha:0},600,Laya.Ease.bounceOut),this.btnClose.on(Laya.Event.CLICK,this,this.onClickContinue),this.btnContinue.on(Laya.Event.CLICK,this,this.onClickContinue)}onEnable(){this._timeLine.play(0,!1)}onDisable(){this._timeLine.pause()}onDestroy(){this._timeLine.destroy(),this._timeLine=null}};Bt=s([Pt("3sO6tbEdRra5Sc8ZeIe78Q")],Bt)})();